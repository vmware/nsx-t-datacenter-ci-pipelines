enable_ansible_debug: false # set value to true for verbose output from ansible

# format: "http://<jumphost_ip>:40001"
nsx_image_webserver: "http://192.168.110.11:40001"

# NSX general network settings
mgmt_portgroup: 'ESXi-RegionA01-vDS-COMP'
dns_server: 192.168.110.10
dns_domain: corp.local.io
ntp_servers: time.vmware.com
default_gateway: 192.168.110.1
netmask: 255.255.255.0

# NSX manager cluster configs
nsx_manager_ips: 192.168.110.33,192.168.110.34,192.168.110.35 # 3 node cluster is recommended. 1 is minimum, 3 is max
nsx_manager_username: admin
nsx_manager_password: Admin!23Admin
nsx_manager_hostname_prefix: "nsxt-mgr" # Generated hostname: nsxt-mgr-1.corp.local.io, will be FQDN
nsx_manager_root_pwd: Admin!23Admin # Min 12 chars, upper, lower, number, special digit
nsx_manager_cli_pwd: Admin!23Admin
nsx_manager_deployment_size: small # Recommended for real bare-bones demo, smallest setup
nsx_manager_deployment_ip_prefix_length: 23
nsx_manager_ssh_enabled: true
vcenter_ip: 192.168.110.22
vcenter_username: administrator@corp.local
vcenter_password: "VMware1!"
vcenter_datacenter: RegionA01
vcenter_cluster: RegionA01-MGMT # management cluster
vcenter_datastore: iscsi
resource_reservation_off: true

# Compute manager credentials should be the same as above vCenter's if
# controllers and edges are to be on the same vCenter
compute_manager_username: "Administrator@vsphere.local"
compute_manager_password: "VMware1!"
# compute manager for the compute cluster (2nd vCenter)
compute_manager_2_vcenter_ip: "null"
compute_manager_2_username: "null"
compute_manager_2_password: "null"

esxi_uplink_profile_vlan: 0 # For internal overlay connection used by Esxi hosts, usually trasnport VLAN ID
edge_uplink_profile_vlan: 0 # For outbound uplink connection used by Edge, usually keep as 0

# Virtual Tunnel Endpoint network ip pool
vtep_ip_pool_cidr: 192.168.213.0/24
vtep_ip_pool_gateway: 192.168.213.1
vtep_ip_pool_start: 192.168.213.10
vtep_ip_pool_end: 192.168.213.200

## Edge nodes for default T0 router
edge_cluster_name: Edge-Cls-Default
edge_ips: 192.168.110.37,192.168.110.38  #comma separated based in number of required edges
edge_default_gateway: 192.168.110.1
edge_ip_prefix_length: 24
edge_hostname_prefix: nsx-t-edge
edge_transport_node_prefix: edge-transp-node
edge_cli_password: "VMware1!"
edge_root_password: "VMware1!"
edge_deployment_size: "large" #Large recommended for PKS deployments
vc_datacenter_for_edge: RegionA01
vc_cluster_for_edge: RegionA01-MGMT
vc_datastore_for_edge: iscsi
vc_uplink_network_for_edge: "ESXi-RegionA01-vDS-COMP"
vc_overlay_network_for_edge: "VM-RegionA01-vDS-COMP"
vc_management_network_for_edge: "ESXi-RegionA01-vDS-COMP"

# Default Tier 0 router
tier0_router_name: SharedT0Router
tier0_uplink_port_ip: 192.168.100.4
tier0_uplink_port_subnet: 24
tier0_uplink_next_hop_ip: 192.168.100.1
tier0_uplink_port_ip_2: 192.168.100.5
tier0_ha_vip: 192.168.100.3
external_connectivity_vlan: 0
vlan_logical_switch_name: shared_vlan_ls
inter_tier0_network_ip: 50.0.0.1
inter_tier0_network_ip_2: 50.0.0.2
is_tanent: false
bgp_as_number: 65200

# Tenant edge clusters (one needed for each tenant)
tenant_edge_clusters:

- edge_cluster_name: Edge-Cls-Tenant1
  edge_ips: 192.168.110.47,192.168.110.48  #comma separated based in number of required edges
  edge_default_gateway: 192.168.110.1
  edge_ip_prefix_length: 24
  edge_hostname_prefix: tenant1-edge
  edge_transport_node_prefix: tenant1-edge-transp-node
  edge_cli_password: "VMware1!"
  edge_root_password: "VMware1!"
  edge_deployment_size: "large"   #Large recommended for PKS deployments
  vc_datacenter_for_edge: RegionA01
  vc_cluster_for_edge: RegionA01-edge-cls2
  vc_datastore_for_edge: edge-datastore
  vc_uplink_network_for_edge: Tanent1-T0-uplink
  vc_overlay_network_for_edge: Tanent1-T0-Overlay
  vc_management_network_for_edge: "ESXi-RegionA01-vDS-COMP"

- edge_cluster_name: Edge-Cls-Tenant2
  edge_ips: 192.168.110.57,192.168.110.58  #comma separated based in number of required edges
  edge_default_gateway: 192.168.110.1
  edge_ip_prefix_length: 24
  edge_hostname_prefix: tenant2-edge
  edge_transport_node_prefix: tenant2-edge-transp-node
  edge_cli_password: "VMware1!"
  edge_root_password: "VMware1!"
  edge_deployment_size: "large"   #Large recommended for PKS deployments
  vc_datacenter_for_edge: RegionA01
  vc_cluster_for_edge: RegionA01-edge-cls3
  vc_datastore_for_edge: edge-datastore
  vc_uplink_network_for_edge: Tanent1-T0-uplink
  vc_overlay_network_for_edge: Tanent1-T0-Overlay
  vc_management_network_for_edge: "ESXi-RegionA01-vDS-COMP"

# Tenant Tier 0 routers (one needed for each tenant)
tenant_t0s:

- tier0_router_name: Tenant1T0Router
  tier0_uplink_port_ip: 192.168.101.4
  tier0_uplink_port_subnet: 24
  tier0_uplink_next_hop_ip: 192.168.101.1
  tier0_uplink_port_ip_2: 192.168.101.5
  tier0_ha_vip: 192.168.101.3
  edge_cluster_name: Edge-Cls-Tenant1 #refer to the edge cluster name set for this T0
  external_connectivity_vlan: 0
  vlan_logical_switch_name: tenant1_vlan_ls
  inter_tier0_network_ip: 50.0.0.3
  inter_tier0_network_ip_2: 50.0.0.4
  is_tanent: true
  bgp_as_number: 65201

- tier0_router_name: Tenant2T0Router
  tier0_uplink_port_ip: 192.168.102.4
  tier0_uplink_port_subnet: 24
  tier0_uplink_next_hop_ip: 192.168.102.1
  tier0_uplink_port_ip_2: 192.168.102.5
  tier0_ha_vip: 192.168.102.3
  edge_cluster_name: Edge-Cls-Tenant2 #refer to the edge cluster name set for this T0
  external_connectivity_vlan: 0
  vlan_logical_switch_name: tenant2_vlan_ls
  inter_tier0_network_ip: 50.0.0.5
  inter_tier0_network_ip_2: 50.0.0.6
  is_tanent: true
  bgp_as_number: 65202

# Inter-T0 Logical network
inter_t0_logical_switch_name: inter-t0-logical-switch
inter_t0_transport_zone_name: inter-t0-tz
inter_t0_vlan: 0
inter_t0_cidr: 50.0.0.0/24

## ESX hosts
#Intsll vSphere clusters automatically
clusters_to_install_nsx: RegionA01-MGMT,RegionA01-K8s    #Comma seprated
per_cluster_vlans: 0,0  #Comma seprated, order of VLANs applied same as order of clusters

esx_ips: "" # additional esx hosts, if any, to be individually installed
esx_os_version: "6.5.0"
esx_root_password: "ca$hc0w"
esx_hostname_prefix: "esx-host"
esx_available_vmnic: "vmnic1" # comma separated physical NICs, applies to both cluster installation or ESXi installation

## BGP related configurations
nsx_t_ip_prefix_spec: |
  ip_prefix_lists:
  - display_name: "shared-t0-prefixes"
    t0_router: SharedT0Router     # Name as specified in the Default Tier 0 router section above
    prefixes:
    - action: "PERMIT"
      network: 30.0.0.0/24        # PKS management network
    - action: "PERMIT"
      network: 192.168.110.0/24   # NSX management network
    - action: "DENY"
      network: 0.0.0.0/24

  - display_name: "tenant1-t0-prefixes"
    t0_router: Tenant1T0Router     # Name as specified in the tenant_t0s section above
    prefixes:
    - action: "PERMIT"
      network: 30.0.128.0/17       # K8S Node network
      ge: 24
      le: 24
    # TODO!! An unknown permit network here
    - action: "DENY"
      network: 0.0.0.0/24

  - display_name: "tenant2-t0-prefixes"
      t0_router: Tenant2T0Router     # Name as specified in the tenant_t0s section above
      prefixes:
      # TODO!! Check this is k8s node network for tenant 2
      - action: "PERMIT"
        network: 40.0.128.0/17       # K8S Node network
        ge: 24
        le: 24
      # TODO!! An unknown permit network here
      - action: "DENY"
        network: 0.0.0.0/24

nsx_t_t0_bgp_spec: |
  bgp_configs:
  - display_name: "shared-t0-bgp"
    t0_router: SharedT0Router
    neighbors:
    - type: "t0_router"
      t0_router_name: Tenant1T0Router
      out_filter_ip_prefix: shared-t0-prefixes
    - type: "t0_router"
      t0_router_name: Tenant2T0Router
      out_filter_ip_prefix: shared-t0-prefixes  # Refer to the ip prefix created above
    redistribution_configs:
    - rule_name: shared-criteria
      sources: [T0_STATIC, T0_CONNECTED, T1_STATIC]

  - display_name: "tenant1-t0-bgp"
    t0_router: Tenant1T0Router
    neighbors:
    - type: "t0_router"
      t0_router_name: SharedT0Router
      out_filter_ip_prefix: tenant1-t0-prefixes  # Refer to the ip prefix created above
    redistribution_configs:
    - rule_name: tenant1-criteria
      sources: [T0_CONNECTED, T1_STATIC, T0_NAT]

  - display_name: "tenant2-t0-bgp"
    t0_router: Tenant2T0Router
    neighbors:
    - type: "t0_router"
      t0_router_name: SharedT0Router
      out_filter_ip_prefix: tenant2-t0-prefixes  # Refer to the ip prefix created above
    redistribution_configs:
    - rule_name: tenant2-criteria
      sources: [T0_CONNECTED, T1_STATIC, T0_NAT]
